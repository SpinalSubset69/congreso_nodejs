(()=>{var e={458:(e,t,r)=>{r(142).config();const s={port:process.env.PORT||3e3,mongodburi:process.env.MONGODB_URI,emailSender:process.env.EMAIL_SENDER_ID,emailSenderPassword:process.env.EMAIL_SENDER_PASSWORD,emailDestination:process.env.EMAIL_DESTINATION_ID};e.exports=s},84:(e,t,r)=>{const s=r(458),n=r(184),o=r(149),a=r(353),i=r(722),c=r(97),u=r(147),d=r(17),m={sendEmail:async(e,t)=>{const r=e.body,m=u.readFileSync(d.join(__dirname,"./../email/index.hbs"),"utf8");try{const e=a(r),i=n.createTransport(o({service:"gmail",host:"smtp.gmail.com",auth:{user:s.emailSender,pass:s.emailSenderPassword}})),u=c.compile(m)({email:e.email,subject:e.subject,phone:e.phone,name:e.name,body:e.body}),d={from:s.emailSender,to:s.emailDestination,subjbect:r.subject,html:u};i.sendMail(d).then(((e,r)=>{e?t.status(200).json({statusCode:200,message:"Email sent",data:e}):t.status(500).json({statusCode:200,message:"There was a problem",data:r})})).catch((e=>{console.log(e)}))}catch(e){i(t,e)}}};e.exports=m},617:(e,t,r)=>{const s=r(722),n=r(705),o=r(820),a={PutStudent:async(e,t)=>{const r=e.body;try{const e=n(r),s={name:r.activity,day:r.day,hour:r.hour,registerAt:r.registerAt},a=await o.findOne({studentNumber:r.studentNumber});if(a)return a.name=r.name,a.phone=r.phone,a.email=r.Email,a.career=r.career,a.IsActivityRegistered(r.activity)?(await a.save(),void t.status(400).json({statusCode:400,message:`Already registered on activity ${r.activity}`})):(a.AddActivity(s),await a.save(),void t.status(200).json({statusCode:200,data:a}));const i=new o(e);return i.AddActivity(s),await i.save(),void t.status(200).json({statusCode:200,data:i})}catch(e){s(t,e)}},GetStudents:async(e,t)=>{try{const e=await o.find();t.status(200).json({message:"OK",numberStudents:e.length,data:e})}catch(e){s(t,e)}}};e.exports=a},642:(e,t,r)=>{const s=r(185),n=r(458);s.connect(n.mongodburi,{useNewUrlParser:!0}).then((()=>{console.log("Database Connected!!")})).catch((e=>{console.log("Error: "+e)}))},353:(e,t,r)=>{const s=r(571),n=r(610);e.exports=function(e=n("EmailInfo")){return function({name:e=n("Name"),phone:t=n("Phone"),email:r=n("Email"),subject:o=n("Subject"),body:a=n("body")}){return function(e){if(e.length<4)throw new s("Insert a valid name")}(e),function(e){if(e.length<10)throw new s("Insert a valid phone number, must be at least 10 digits and ")}(t),function(e){if(!new RegExp(/^[^@\s]+@[^@\s]+\.[^@\s]+$/).test(e))throw new s("Insert a valid email direction(example@example.com)")}(r),function(e){if(e.length<5)throw new s("Insert a valid subject, must be at least 5 character and ")}(o),function(e){if(e.length<10)throw new s("Insert a valid message, must be at least 10 characters and")}(a),{name:e,phone:t,email:r,subject:o,body:a}}(e)}},705:(e,t,r)=>{const s=r(571),n=r(610);function o(e){const t=["sistemas","nutricion","nutrición","enfermeria","enfermería","contador","bioquimico","bioquímico","agronomo","agrónomo"],r=e.split(" ");for(let e=0;e<t.length;e++)for(let s=0;s<r.length;s++)if(t[e].toLowerCase()===r[s].toLowerCase())return!0;return!1}e.exports=function(e=n("UserInfo")){return function({name:e=n("name"),studentNumber:t=n("StudentNumber"),day:r=n("Day"),hour:a=n("Hour"),registerAt:i=n("RegisterAt"),career:c=n("Career"),activity:u=n("Activity"),email:d=n("Email"),phone:m}){return function(e){if(e.length<=0)throw new s("Insert a Valid Name")}(e),function(e){if(!new RegExp(/([a])\d+/).test(e))throw new s("Insert a valid StudentNumber(a Followed by only numbers)")}(t),function(e){if(!["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].includes(e.toLowerCase()))throw new s("Insert a valid day")}(r),function(e){if(e<0)throw new s("Insert a valid Hour")}(a),function(e){if(!e)throw new s("Insert a date to register student")}(i),function(e){if(!o(e))throw new s("Insert a valide Career")}(c),function(e){if(!o(e))throw new s("Insert a valid Activity")}(u),function(e){if(!new RegExp(/^[^@\s]+@[^@\s]+\.[^@\s]+$/).test(e))throw new s("Insert a valid email direction(example@example.com)")}(d),{name:e,studentNumber:t,day:r,hour:a,registerAt:i,career:c,activity:u,phone:m,email:d}}(e)}},571:e=>{e.exports=class e extends Error{constructor(t){super(t),Error.captureStackTrace&&Error.captureStackTrace(e)}},e.exports=class e extends Error{constructor(t){super(`${t} cannot be null or undefined`),Error.captureStackTrace&&Error.captureStackTrace(this,e)}}},722:(e,t,r)=>{const s=r(571);e.exports=function(e,t){const r=t instanceof s?400:500;return e.status(r).json({errorMessage:t.message,statusCode:r})}},610:(e,t,r)=>{const s=r(571);e.exports=function(e){throw new s(e)}},820:(e,t,r)=>{const s=r(185),n=new s.Schema({name:String,day:String,hour:String,registerAt:String}),o=new s.Schema({id:String,name:String,email:String,studentNumber:String,phone:String,career:String,Activities:[n]});o.methods.AddActivity=function(e){this.Activities.includes(e)||this.Activities.push(e)},o.methods.IsActivityRegistered=function(e){for(let t of this.Activities)if(t.name===e)return!0;return!1},e.exports=s.model("Student",o)},70:(e,t,r)=>{const s=r(860).Router(),n=r(617),o=r(84);s.get("/getStudents",n.GetStudents),s.post("/postStudent",n.PutStudent),s.post("/sendemail",o.sendEmail),e.exports=s},279:(e,t,r)=>{const s=r(860),n=s();r(642);const o=r(70),a=r(582),i=r(17);n.use(a()),n.use(s.json()),n.use(s.static(i.join(__dirname,"public"))),n.use("/api",o),e.exports=n},582:e=>{"use strict";e.exports=require("cors")},142:e=>{"use strict";e.exports=require("dotenv")},860:e=>{"use strict";e.exports=require("express")},97:e=>{"use strict";e.exports=require("handlebars")},185:e=>{"use strict";e.exports=require("mongoose")},184:e=>{"use strict";e.exports=require("nodemailer")},149:e=>{"use strict";e.exports=require("nodemailer-smtp-transport")},147:e=>{"use strict";e.exports=require("fs")},17:e=>{"use strict";e.exports=require("path")}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}(()=>{const e=r(279),t=r(458);e.listen(t.port,(()=>{console.log("Server started")}))})(),module.exports={}})();